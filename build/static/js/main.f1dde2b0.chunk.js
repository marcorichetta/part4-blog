(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{206:function(e,t,n){e.exports=n(362)},362:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(39),u=n.n(c),i=n(23),o=(n(215),n(33)),l=n(48),s=n(46),m=n(382),f=function(){var e=window.location.pathname,t=Object(a.useState)(e),n=Object(s.a)(t,2),c=n[0],u=n[1],i=function(e,t){var n=t.to;return u(n)};return r.a.createElement(m.a,{pointing:!0,secondary:!0},r.a.createElement(m.a.Item,{as:o.b,to:"/",name:"home",active:"/"===c,onClick:i}),r.a.createElement(m.a.Item,{as:o.b,to:"/users",name:"/users",active:"/users"===c,onClick:i}))},d=n(383),p=function(){return r.a.createElement(d.a,{inverted:!0},"Part 5 - Blog App")},E=n(381),b=Object(i.b)((function(e){return{notifications:e.notifications}}))((function(e){var t=e.notifications.text,n=e.notifications.style;return void 0===t?null:r.a.createElement(r.a.Fragment,null,"positive"===n?r.a.createElement(E.a,{positive:!0},t):r.a.createElement(E.a,{error:!0},t))})),v=n(10),g=n.n(v),h=n(18),O=n(30),y=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),r=n[0],c=n[1];return{type:e,value:r,onChange:function(e){c(e.target.value)},reset:function(){c("")}}},w=n(97),j=n(57),k=n(44),x=n.n(k),C="".concat("https://part4-blog-backend.herokuapp.com","/api/"),I={login:function(){var e=Object(h.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post(C+"login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllUsers:function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get(C+"users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},T="".concat("https://part4-blog-backend.herokuapp.com","/api/blogs"),N=null,L=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get(T);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,x.a.post(T,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(h.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("".concat(T,"/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U={setToken:function(e){N="bearer ".concat(e)},getAll:L,create:A,update:function(){var e=Object(h.a)(g.a.mark((function e(t,n){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.put("".concat(T,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(h.a)(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,x.a.delete("".concat(T,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createComment:B},S={currentUser:void 0,userList:[]},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(j.a)({},e,{currentUser:t.data});case"LOGOUT":return"";case"GET_USERS":return Object(j.a)({},e,{userList:t.data});case"NEW_BLOG":var n=t.data,a=t.data.user,r=Object(w.a)(e.userList);return r.find((function(e){return e.id===a})).blogs.push(n),Object(j.a)({},e,{userList:r});default:return e}},F=function(e,t,n){return function(){var a=Object(h.a)(g.a.mark((function a(r){return g.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r({type:"CREATE_NOTIFICATION",data:{text:(c={text:e,style:t}).text,style:c.style}});case 2:setTimeout((function(){r({type:"REMOVE_NOTIFICATION"})}),1e3*n);case 3:case"end":return a.stop()}var c}),a)})));return function(e){return a.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_NOTIFICATION":return t.data;case"REMOVE_NOTIFICATION":return"";default:return e}},G=n(363),D=n(375),M=n(371),W=n(43),z={login:function(e){return function(){var t=Object(h.a)(g.a.mark((function t(n){var a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.login(e);case 2:a=t.sent,U.setToken(a.token),window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(a)),n({type:"LOGIN",data:a});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},logout:function(){return{type:"LOGOUT"}},setNotification:F},H=Object(i.b)((function(e){return{currentUser:e.users.currentUser}}),z)((function(e){var t=y("text"),n=y("password"),c=t.reset,u=Object(O.a)(t,["reset"]),i=n.reset,o=Object(O.a)(n,["reset"]),l=Object(a.useState)(!1),m=Object(s.a)(l,2),f=m[0],d=m[1],p=function(){var t=Object(h.a)(g.a.mark((function t(n){var a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{a={username:n.target.username.value,password:n.target.password.value},e.login(a)}catch(r){e.setNotification("Wrong credentials. Try again.","negative",5)}c(),i();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.localStorage.removeItem("loggedBlogAppUser"),c(),i(),d(!1),e.logout();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),b={display:f?"none":""},v={display:f?"":"none"};return r.a.createElement("div",null,void 0===e.currentUser?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:b},r.a.createElement(G.a,{onClick:function(){return d(!0)},color:"green"},"Log In")),r.a.createElement("div",{style:v},r.a.createElement("h2",null,"Login"),r.a.createElement(D.a,{onSubmit:p},r.a.createElement(D.a.Field,{inline:!0,required:!0},r.a.createElement("label",null,"Username"),r.a.createElement(M.a,Object.assign({name:"username"},u,{"data-cy":"username"}))),r.a.createElement(D.a.Field,{inline:!0,required:!0},r.a.createElement("label",null,"Password"),r.a.createElement(M.a,Object.assign({name:"password"},o,{"data-cy":"password"}))),r.a.createElement(G.a,{positive:!0,type:"submit","data-cy":"submit"},"Submit"),r.a.createElement(G.a,{type:"button",onClick:function(){return d(!1)}},"Cancel")))):r.a.createElement("p",null,r.a.createElement(W.a,{name:"user circle"}),r.a.createElement("b",null,e.currentUser.name)," logged in",r.a.createElement(G.a,{negative:!0,style:{margin:"10px"},onClick:E},"Log out")))})),K=function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),c=n[0],u=n[1],i={display:c?"none":""},o={display:c?"":"none"},l=function(){u(!c)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:i},r.a.createElement(G.a,{positive:!0,onClick:l,"data-cy":"new-blog"},e.buttonLabel)),r.a.createElement("div",{style:o},e.children,r.a.createElement("br",null),r.a.createElement(G.a,{onClick:l},"Cancel")))},J=function(e){return function(){var t=Object(h.a)(g.a.mark((function t(n){var a,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={likes:e.likes+1},t.next=3,U.update(e.id,a);case 3:r=t.sent,n({type:"LIKE",data:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},V=function(e){return function(){var t=Object(h.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U.deleteBlog(e.id);case 2:n({type:"REMOVE",data:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(w.a)(e),[t.data]);case"NEW_COMMENT":var n=t.data.id,a=e.find((function(e){return e.id===n})),r=Object(j.a)({},a,{comments:t.data.comments});return e.map((function(e){return e.id!==n?e:r}));case"LIKE":var c=t.data.id,u=e.find((function(e){return e.id===c})),i=Object(j.a)({},u,{likes:u.likes+1});return e.map((function(e){return e.id!==c?e:i}));case"REMOVE":var o=t.data.id;return e.filter((function(e){return e.id!==o}));default:return e}},q={createBlog:function(e){return function(){var t=Object(h.a)(g.a.mark((function t(n){var a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U.create(e);case 2:a=t.sent,n({type:"NEW_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},setNotification:F},Q=Object(i.b)((function(e){return{currentUser:e.users.currentUser}}),q)((function(e){var t=y("text"),n=y("text"),a=y("text"),c=t.reset,u=Object(O.a)(t,["reset"]),i=n.reset,o=Object(O.a)(n,["reset"]),l=a.reset,s=Object(O.a)(a,["reset"]),m=function(){var r=Object(h.a)(g.a.mark((function r(u){var o,s;return g.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:u.preventDefault(),o={title:t.value,author:n.value,url:a.value,user:e.currentUser.id},e.createBlog(o),s='A new blog "'.concat(o.title,'" was created'),e.setNotification(s,"positive",5),c(),i(),l();case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Create a new blog post"),r.a.createElement(D.a,{onSubmit:m,size:"small"},r.a.createElement(D.a.Input,Object.assign({label:"Title",name:"title",width:4},u,{"data-cy":"title-input"})),r.a.createElement(D.a.Input,Object.assign({label:"Author",name:"author",width:4},o,{"data-cy":"author-input"})),r.a.createElement(D.a.Input,Object.assign({label:"URL",name:"url",width:4},s,{"data-cy":"url-input"})),r.a.createElement(G.a,{positive:!0,type:"submit","data-cy":"blog-submit"},"Create")))})),X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CREATED",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER":return t.filter;default:return e}},Y=n(384),Z=n(377),$=function(e){var t=e.blogs;return"LIKES"===e.filter?Array.from(t).sort((function(e,t){return t.likes-e.likes})):t},ee={likeBlog:J,removeBlog:V,filterChange:function(e){return{type:"SET_FILTER",filter:e}}},te=Object(i.b)((function(e){return{visibleBlogs:$(e),filter:e.filter,currentUser:e.users.currentUser,notifications:e.notifications}}),ee)((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{as:"h4",dividing:!0},"Order by"),r.a.createElement(D.a,null,r.a.createElement(D.a.Radio,{label:"Creation Order",checked:"CREATED"===e.filter,name:"filter",onChange:function(){return e.filterChange("CREATED")}}),r.a.createElement(D.a.Radio,{label:"Most liked",name:"filter",checked:"LIKES"===e.filter,onChange:function(){return e.filterChange("LIKES")}})),r.a.createElement(Z.a.Group,{divided:!0},e.visibleBlogs.map((function(e){return r.a.createElement(Z.a,{key:e.id,id:"blog",as:o.b,to:"/blogs/".concat(e.id)},r.a.createElement(Z.a.Header,null,e.title))}))))})),ne=n(378),ae=Object(i.b)((function(e){return{users:e.users.userList}}))((function(e){return void 0===e.users?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{as:"h2"},"Users"),r.a.createElement(ne.a,{compact:!0},r.a.createElement(ne.a.Header,null,r.a.createElement(ne.a.Row,null,r.a.createElement(ne.a.HeaderCell,null,"Username"),r.a.createElement(ne.a.HeaderCell,null,"N\xb0 of blogs created"))),r.a.createElement(ne.a.Body,null,e.users.map((function(e){return r.a.createElement(ne.a.Row,{key:e.id},r.a.createElement(ne.a.Cell,null,r.a.createElement(o.b,{to:"/users/".concat(e.id)},e.username)),r.a.createElement(ne.a.Cell,null,e.blogs.length))})))))})),re=n(372),ce=n(380),ue=n(379),ie=Object(i.b)((function(e,t){var n=t.id;return{userData:e.users.userList.find((function(e){return e.id===n}))}}))((function(e){if(void 0===e.userData)return r.a.createElement(re.a,{active:!0,inline:"centered"});var t=e.userData,n=t.blogs,a=Object(O.a)(t,["blogs"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce.a,{header:"Name: ".concat(a.name),meta:"Username: ".concat(a.username),extra:"N\xb0 of blogs: ".concat(n.length)}),r.a.createElement(Y.a,{as:"h3"},"Added blogs"),r.a.createElement(ue.a,{animated:!0,celled:!0},n.map((function(e){return r.a.createElement(ue.a.Item,{key:e.id},r.a.createElement("li",null,e.title))}))))})),oe=n(373),le={likeBlog:J,removeBlog:V,addComment:function(e,t){return function(){var n=Object(h.a)(g.a.mark((function n(a){var r,c;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={id:t.id,newComment:e,comments:t.comments},n.next=3,U.createComment(r);case 3:c=n.sent,a({type:"NEW_COMMENT",data:c});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},setNotification:F},se=Object(l.e)((function(e){var t=y("text"),n=t.reset,a=Object(O.a)(t,["reset"]);if(void 0===e.blogData)return null;var c=e.blogData,u=function(){var t=Object(h.a)(g.a.mark((function t(a){var r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault();try{r=a.target.comment.value,e.addComment(r,c)}catch(u){e.setNotification("Wrong credentials. Try again.","negative",5)}n();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce.a,null,r.a.createElement(ce.a.Content,null,r.a.createElement(ce.a.Header,null,c.title),r.a.createElement(ce.a.Meta,null,"Added by ",c.author),""===c.url?"No url provided":r.a.createElement(ce.a.Content,{extra:!0},r.a.createElement(W.a,{name:"linkify"})," ",c.url),r.a.createElement(oe.a,null),r.a.createElement(ce.a.Content,{extra:!0},r.a.createElement(G.a,{content:"Like",labelPosition:"right",icon:"heart",label:{as:"a",basic:!0,content:c.likes},onClick:function(){return function(t){e.likeBlog(t);var n="The blog ".concat(t.title," was liked");e.setNotification(n,"positive",5)}(c)}}),r.a.createElement(G.a,{basic:!0,color:"red",icon:"trash",onClick:function(){return function(t){if(window.confirm("Remove ".concat(t.title," by ").concat(t.author,"?"))){e.removeBlog(t),e.history.push("/");var n="The blog ".concat(t.title," was deleted");e.setNotification(n,"negative",5)}return 0}(c)}})))),r.a.createElement(oe.a,null),r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{as:"h4"},"Comments"),0===c.comments.length?"This blog has no comments yet":r.a.createElement(ue.a,{divided:!0,animated:!0},c.comments.map((function(e){return r.a.createElement(ue.a.Item,{key:e},e)}))),r.a.createElement(D.a,{onSubmit:u},r.a.createElement(D.a.Input,Object.assign({name:"comment",width:4,placeholder:"Great post!"},a,{"data-cy":"comment-input"})),r.a.createElement(G.a,{type:"submit"},"Add comment"))))})),me=Object(i.b)((function(e,t){var n=t.id;return{blogData:e.blogs.find((function(e){return e.id===n}))}}),le)(se),fe=n(374),de={initializeBlogs:function(){return function(){var e=Object(h.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},relogin:function(e){return U.setToken(e.token),{type:"LOGIN",data:e}},getAllUsers:function(){return function(){var e=Object(h.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getAllUsers();case 2:n=e.sent,t({type:"GET_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},pe=Object(i.b)(null,de)((function(e){Object(a.useEffect)((function(){e.initializeBlogs(),e.getAllUsers()})),Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogAppUser");if(t){var n=JSON.parse(t);e.relogin(n)}}));return r.a.createElement(fe.a,null,r.a.createElement("div",null,r.a.createElement(Y.a,{as:"h1",style:{marginTop:"2em"},textAlign:"center"},"Blogs App - ",r.a.createElement("a",{href:"https://fullstackopen.com/en/"},"Fullstack Open Course")),r.a.createElement(o.a,null,r.a.createElement(b,null),r.a.createElement(f,null),r.a.createElement(H,null),r.a.createElement(l.a,{exact:!0,path:"/",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{as:"h2"},"Blogs"),r.a.createElement(K,{buttonLabel:"New blog post"},r.a.createElement(Q,null)),r.a.createElement(te,null))}}),r.a.createElement(l.a,{path:"/blogs/:id",render:function(e){var t=e.match;return r.a.createElement(me,{id:t.params.id})}}),r.a.createElement(l.a,{path:"/users",render:function(){return r.a.createElement(ae,null)}}),r.a.createElement(l.a,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return r.a.createElement(ie,{id:t.params.id})}})),r.a.createElement("br",null),r.a.createElement(p,null)))})),Ee=n(55),be=n(193),ve=n(194),ge=Object(Ee.combineReducers)({blogs:P,notifications:_,filter:X,users:R}),he=Object(Ee.createStore)(ge,Object(ve.composeWithDevTools)(Object(Ee.applyMiddleware)(be.a)));u.a.render(r.a.createElement(i.a,{store:he},r.a.createElement(pe,null)),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.f1dde2b0.chunk.js.map